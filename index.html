<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="Description" content="Spotlight[Beta]">
    <meta name="theme-color" content="#FFCF07">
    <meta name="msapplication-TileColor" content="#FFCF07">

    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#FFCF07">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">

    <script src="lib.js"></script>
    <script src="party.min.js" defer></script>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link href="splashscreens/iphone5_splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    <link href="splashscreens/iphone6_splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    <link href="splashscreens/iphoneplus_splash.png" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
    <link href="splashscreens/iphonex_splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
    <link href="splashscreens/iphonexr_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    <link href="splashscreens/iphonexsmax_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
    <link href="splashscreens/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    <link href="splashscreens/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    <link href="splashscreens/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    <link href="splashscreens/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />

    <title>Spotlight[Beta]</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <div id="projector"  class="initial">
      <div id="menu" class="sidebar">
        <div id="hamburger-tab">
          <button style="background:unset;" id="hamburger" aria-label="Menu" onClick="this.classList.toggle('active'); projector.classList.toggle('menu');"><div></div></button>
        </div>
        <div id="menuContents" style="height: 100%; overflow: auto;">
          <h3 style="margin-top: 3rem;">Shortcuts</h3>
          <ul>
            <li id="weeklyData">
              <a href="#locations">Enter More</a>
            </li>
            <li id="semesterData" style="display: none;">
              <div style="vertical-align: middle;">
                <a id="semesterInfobaseAnchor" target="_blank">Enter Semester / Quarterly Data</a>
                <span rel="tooltip" title="Click here to enter Semester / Quarterly Data for the current movement on Infobase" style="line-height: initial; float:right;">i</span>
              </div>
            </li>
            <li id="celebrationSummary">
              <a href="#summary">Celebration Summary</a>
            </li>
            <!--li>
              <a href="#summary">Enter Weekly / Quarterly Data</a>
            </li-->
            <li>
              <a href="#reset">Logout</a>
            </li>
          </ul>
          <h3>Help</h3>
          <ul>
            <!--li>
              <a href="#" target="_blank">Spotlight</a>
            </li-->
            <li>
              <a href="https://sites.google.com/cru.org/infobasehelp" target="_blank">Infobase</a>
            </li>
            <li><a href="" data-part1="spotlight" data-part2="cru" data-part3="org" data-part4="App feedback: ">Contact Us</a>
            </li>
          </ul>
          <h3>Settings</h3>
          <ul>
            <li>
              <a id="add-button" onclick="installPWA();">Install Spotlight</a>
            </li>
            <li noHover>
              <label>
                Font Size: <output id="fontSizeOutput">16px</output><br>
                <input id="fontSize" type="range" min="16" max="20" value="16" id="fontSize" name="fontSize" list="tickmarks" onchange="document.getElementById('fontSizeOutput').value=this.value+'px'; document.documentElement.style.fontSize = this.value+'px'; localStorage.setItem('fontSize', this.value);" style="width: 130px">
                <datalist id="tickmarks">
                  <option value="16" label="16px"></option>
                  <option value="20" label="20px"></option>
                </datalist>
              </label>
            </li>
          </ul>
        </div>
      </div>
      <div id="onboarding" class="screen last-el-bottom">
        <h1>Spotlight<sup style="font-weight: normal; color: var(--main-color)">[Beta]</sup></h1>
        <small>A snapshot of your ministry</small>
        
        <form class="last-el-bottom" id="onboard-form">
          <div class="movementInfo">
            <p>Select the movements below that you would like to add OR click <a href="#onboarding">here</a> to login.  </p>
            <h2>Movements</h2>
            <div id="movements">
          </div>
          <br>
          </div>
          <div class="loginInfo">
            <b>If you have previously registered, go ahead and enter your phone number and pin!</b> <br><br> If you haven't yet registered, you'll need to open the custom link that was sent to you.
          </div>
          <h2 style="margin-bottom: 0;">Account Login</h2>
          <div class="movementInfo">
            <span>
              <input name="register" id="register" type="checkbox" onchange="toggleRegister();">
              <label for="register">Register as new user</label>
            </span>
            <div id="userToggle">
              <label for="regUserName">First name</label><br>
              <input id="regUserName" name="regUserName" type="text" placeholder="What should we call you?" style="width: 100%;">
              <label for="regUserEmail">Email for account recovery</label><br>
              <input id="regUserEmail" name="regUserEmail" type="email" placeholder="Your recovery email address" style="width: 100%">
            </div>
          </div>
          <div class="accountToggle">
            <label for="regUserPhone">Phone Number</label><br>
            <input id="regUserPhone" name="regUserPhone" class="masked" required placeholder="(XXX) XXX-XXXX" pattern="\(\d{3}\) \d{3}-\d{4}" title="(123) 456-7890"><br>
            <label for="regUserPin">Password/Pin Number</label><br>
            <input id="regUserPin" name="regUserPin" type="password" class="masked" required pattern="[0-9]{4}" placeholder="XXXX" style="width: 100%" title="pin for logging in later"><br><br>  
            <small><i>Click <a class="link" onclick="requestPin()">here</a> to recover your pin</i></small>
          </div>
          <div class="movementInfo">
            <span>
              <input name="staff" id="regUserStaff" type="checkbox" onchange="toggleStaff();">
              <label for="regUserStaff">I'm on staff with Cru</label>
            </span>
            <div id="staffToggle">
              <label for="staffAcct">Staff Acct. #</label><br>
              <input id="staffAcct" name="staffAcct" type="tel" class="masked" pattern="[0-9]{7}" placeholder="XXXXXXX" title="enter your staff account number">
            </div>
          </div>
          <div>
            <input id="ua" name="ua" required type="checkbox" >
            <label for="ua" >I agree to the <a href="https://www.cru.org/us/en/about/privacy.html" target="_blank">Cru Privacy Statement</a></label>
          </div>
          <div>
            <span class="bottom-button">
              <button id="formSubmit"><span style="display:none">Register and </span>Setup Device</button>
            </span>
            <span class="questions">
              Questions or Bugs? Send us an <a href="" data-part1="spotlight" data-part2="cru" data-part3="org" data-part4="App feedback: "> 
            email</a>
            </span>
          </div>
        </form>
      </div>

      <div id="locations" class="screen last-el-bottom">
        <h1>Spotlight<sup style="font-weight: normal; color: var(--main-color)">[Beta]</sup></h1>
        <small>A snapshot of your ministry</small>
        <b id="todayDate" style="color: var(--main-color);"></b>
        <p id="strategyWelcomeText"></p>
        <form class="last-el-bottom" id="location-form">
          <h2 style="width: 100%; display: flex;  justify-content: space-between; margin-top: 0;">
            <a class="mvBtn clicky" onclick="goToPrevMovement();">◀ </a>
            <span id="movementName">University of Central Florida Cru</span>
            <a class="mvBtn clicky" onclick="goToNextMovement();"> ▶</a>
          </h2>

          <div id="slideable">
            <input type="hidden" id="movementId" name="movementId">
            <input type="hidden" id="userPhone" name="userPhone">
            
            <div class="activity"><div id="lastUpdate" style="float: left;"></div>My activity</div>

            <div id="statsList"></div>
            <div id="storyBoxContainer"></div>
            
          </div>
          <div>
            <span class="bottom-button">
              <button type="button" onclick="goToPrevMovement();" class="white mvBtn">Previous</button>
              <button type="button" style="width: 40%;" onclick="submitLocationForm();">Submit</button>
              <button type="button" onclick="goToNextMovement();" class="white mvBtn">Next</button>
            </span>
            <span class="questions">
              Questions or Bugs? Send us an <a href="" data-part1="spotlight" data-part2="cru" data-part3="org" data-part4="App feedback: "> 
            email</a>
            </span>
          </div>
        </form>
      </div>

      <div id="summary" class="screen last-el-bottom">
        <h1></h1>

        <div id="reminder">
          <div onclick="document.getElementById('hiddenReminder').classList.remove('visible'); document.getElementById('blurBackground').classList.remove('visible');" id="blurBackground"></div>
          <button onclick="document.getElementById('hiddenReminder').classList.toggle('visible'); document.getElementById('blurBackground').classList.toggle('visible');"><span>&#128197;<!-- 💬--></span> Set a reminder</button>
          <div id="hiddenReminder">
            <p>What day/time?</p>
            <div class="day-of-week">
              <input id="DOW_0-0" type="radio" name="weekday" value="0"><label for="DOW_0-0">S</label>
              <input id="DOW_0-1" type="radio" name="weekday" value="1"><label for="DOW_0-1">M</label>
              <input id="DOW_0-2" type="radio" name="weekday" value="2"><label for="DOW_0-2">T</label>
              <input id="DOW_0-3" type="radio" name="weekday" value="3"><label for="DOW_0-3">W</label>
              <input id="DOW_0-4" type="radio" name="weekday" value="4"><label for="DOW_0-4">T</label>
              <input id="DOW_0-5" type="radio" name="weekday" value="5" checked><label for="DOW_0-5">F</label>
              <input id="DOW_0-6" type="radio" name="weekday" value="6"><label for="DOW_0-6">S</label>
            </div>
            <input type="time" id="reminderTime" name="reminderTime" value="12:00"><br><br>
            <button onclick="setCalendarReminder();">&#128197; Set Google Calendar reminder</button>
            <!--button onclick="setTextReminder();">💬 Set text reminder</button-->
          </div>
        </div>

        <p style="text-align: center;">Thanks for celebrating with us all that God is doing on Campus! Below is just a small snapshot of what God is doing on your campus in the last 3 weeks.</p>
        
        <div id="cards">
        </div>
        
        <div>
          <span class="bottom-button">
            <button onclick="location.hash='';">Enter More</button>
          </span>
          <span class="questions">
            Questions or Bugs? Send us an <a href="" data-part1="spotlight" data-part2="cru" data-part3="org" data-part4="App feedback: "> 
            email</a>
          </span>
        </div>
      </div>
    </div>
    <div id="spin-container">
      <div id="spinner">
      </div>
    </div>
    <div id="install-prompt" style="display: none;"><img src="a2hs.png" style="height:3rem; padding-top:.3rem; padding-right:1rem; float:left"><span>Install Spotlight[beta] on your device: tap <img src="share-apple.svg" style="height: 1.5rem; vertical-align: text-bottom;"> and then Add to homescreen.</span></div>
    <script src="masking-input.js" data-autoinit="true"></script>
    <script rel="preconnect" src="https://unpkg.com/smoothscroll-polyfill@0.4.4/dist/smoothscroll.min.js" async></script>
  </body>
</html>
